<html>
	<head>
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<!-- <div id="canvas" style="width:100%; height:100%">
		</div> -->
		<div id="canvasContainer">
		  <canvas id="Canvas" height="450" width="650"></canvas>
		</div>
	</body>
	<script src="js/three.min.js"> </script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

  <script>

	// // @see http://paulirish.com/2011/requestanimationframe-for-smart-animating/
	// window.requestAnimFrame = (function(){
  //     return  window.requestAnimationFrame       ||
  //             window.webkitRequestAnimationFrame ||
  //             window.mozRequestAnimationFrame    ||
  //             window.oRequestAnimationFrame      ||
  //             window.msRequestAnimationFrame     ||
  //             function(/* function */ callback, /* DOMElement */ element){
  //               window.setTimeout(callback, 1000 / 60);
  //             };
  //   })();

			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );

			var renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );
			camera.position.z = 10;

			window.requestAnimFrame = (function(){
			  return  window.requestAnimationFrame       ||
			          window.webkitRequestAnimationFrame ||
			          window.mozRequestAnimationFrame    ||
			          window.oRequestAnimationFrame      ||
			          window.msRequestAnimationFrame     ||
			          function( callback ){
			            window.setTimeout(callback, 1000 / 60);
			          };
			})();

			// Drawing particles

			// Init stuff
			var canvas = document.getElementById("Canvas");
			var c = canvas.getContext("2d");
			var particles = [];
			var counter = 0;

			function createParticles() {
				// every 10th count
				counter +=1 ;
				if (counter % 10 == 0) {
					if (particles.length < 100)  {
            // particles.push({
            //         x: Math.random()*canvas.width, //between 0 and canvas width
            //         y: Math.random()*canvas.height,
            //         speed: 2+Math.random()*3, //between 2 and 5
            //         radius: 5+Math.random()*5, //between 5 and 10
            //         color: "white",
            // });
            particles.push({
                    // x: Math.random()*canvas.width, //between 0 and canvas width
                    // y: Math.random()*canvas.height,
				                    init_x: Math.random()*canvas.width, //between 0 and canvas width
				                    init_y: Math.random()*canvas.height,
								                    x: Math.random()*canvas.width, //between 0 and canvas width
								                    y: Math.random()*canvas.height,
                    speed: 2+Math.random()*3, //between 2 and 5
                    radius: 5+Math.random()*5, //between 5 and 10
										base_radius: Math.random() * 20,
                    color: "white",
            });
					}
				}
			}

			function circularParticleMotion(particle){
				v = particle.speed;
				R = particle.base_radius;
				// t = counter-based
				t= counter;
				theta = v * t / R;
				// theta = v * t / R

				// x = R  * cos (theta)
				new_x = R * Math.cos(theta) + particle.init_x;
				// y = R  * sin (theta)
				new_y = R * Math.sin(theta) + particle.init_y;
				return [new_x, new_y];
			}

			function updateParticles() {
				for (var i in particles)  {
					var particle = particles[i];
					particle.x = circularParticleMotion(particle)[0];
					particle.y = circularParticleMotion(particle)[1];
				}
			}


			function killParticles() {
				for (var i in particles) {
					var particle = particles[i];
					if (particle.y > canvas.height) {
						particle.y = 0
					}
				}
			}

			function drawParticles() {
		    c.fillStyle = "black";
		    c.fillRect(0,0,canvas.width,canvas.height);
		    for(var i in particles) {
		        var part = particles[i];
		        c.beginPath();
		        c.arc(part.x,part.y, part.radius, 0, Math.PI*2);
		        c.closePath();
		        c.fillStyle = part.color;
		        c.fill();
		    }
			}

			// Main loop for rendering particles
			function loop() {
				window.requestAnimFrame(loop);
				createParticles();
				updateParticles();
				killParticles();
				drawParticles();
			}
			window.requestAnimFrame(loop);

			// var x = 0;
			// function drawIt() {
			//     window.requestAnimFrame(drawIt);
			//     // var canvas = document.getElementById('canvas');
			//     // var c = canvas.getContext('2d');
			// 		var canvas = document.getElementById("Canvas");
			// 		var c = canvas.getContext("2d");
			//     c.fillStyle = "red";
			//     c.fillRect(x,100,200,100);
			//     x+=5;
			// }
			// window.requestAnimFrame(drawIt);


  </script>
</html>
